<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    ã€ŒCodeForces 1261Dã€Wrong Answer on test 233 | dinnerhunt
</title>
<link rel="shortcut icon" href="https://dinnerhunt.cn/favicon.ico?v=1654671103475">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://dinnerhunt.cn/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dinnerhunt.cn/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/stackoverflow-light.min.css">

<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://dinnerhunt.cn">
                <img class="avatar" src="https://dinnerhunt.cn/images/avatar.png?v=1654671103475" alt="">
            </a>
            <div class="site-title">
                <h1>
                    dinnerhunt
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    é¦–é¡µ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    å½’æ¡£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    æ ‡ç­¾
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    å…³äº
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/friend" class="menu">
                                    å‹é“¾
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            ã€ŒCodeForces 1261Dã€Wrong Answer on test 233
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2019-12-13</time>
                            
                                <a href="https://dinnerhunt.cn/tag/iO4MbBtKg/" class="post-tag i-tag
                            i-tag-other_1">
                            #ç»„åˆæ•°å­¦
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>This is the harder version of the problem. In this version, 1â‰¤ğ‘›â‰¤2â‹…105. You can hack this problem if you locked it. But you can hack the previous problem only if you locked both problems.</p>
<p>The problem is to finish ğ‘› one-choice-questions. Each of the questions contains ğ‘˜ options, and only one of them is correct. The answer to the ğ‘–-th question is â„ğ‘–, and if your answer of the question ğ‘– is â„ğ‘–, you earn 1 point, otherwise, you earn 0 points for this question. The values â„1,â„2,â€¦,â„ğ‘› are known to you in this problem.</p>
<!--more-->
<p>However, you have a mistake in your program. It moves the answer clockwise! Consider all the ğ‘› answers are written in a circle. Due to the mistake in your program, they are shifted by one cyclically.</p>
<p>Formally, the mistake moves the answer for the question ğ‘– to the question ğ‘–modğ‘›+1. So it moves the answer for the question 1 to question 2, the answer for the question 2 to the question 3, ..., the answer for the question ğ‘› to the question 1.</p>
<p>We call all the ğ‘› answers together an answer suit. There are ğ‘˜ğ‘› possible answer suits in total.</p>
<p>You're wondering, how many answer suits satisfy the following condition: after moving clockwise by 1, the total number of points of the new answer suit is strictly larger than the number of points of the old one. You need to find the answer modulo 998244353.</p>
<p>For example, if ğ‘›=5, and your answer suit is ğ‘=[1,2,3,4,5], it will submitted as ğ‘â€²=[5,1,2,3,4] because of a mistake. If the correct answer suit is â„=[5,2,2,3,4], the answer suit ğ‘ earns 1 point and the answer suite ğ‘â€² earns 4 points. Since 4&gt;1, the answer suit ğ‘=[1,2,3,4,5] should be counted.</p>
<h4 id="é“¾æ¥">é“¾æ¥ğŸ”—</h4>
<p><a href="https://codeforces.com/contest/1261/problem/D2">ã€ŒCodeForces 1261Dã€Wrong Answer on test 233</a></p>
<h4 id="é¢˜è§£">é¢˜è§£</h4>
<p>è€ƒè™‘æ¯ä¸ªä½ç½®æ‰€å¡«ç­”æ¡ˆå¯¹æ­£ç¡®æ•°é‡çš„å½±å“ã€‚å¦‚æœ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>=</mo><mo>=</mo><mi>s</mi><mo>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">s[i] == s[i+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span>ï¼Œé‚£ä¹ˆæ­£ç¡®æ•°é‡æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œå› ä¸º å¦‚æœæ‰€å¡«ç­”æ¡ˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mo>=</mo><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">x== s[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span> é‚£ä¹ˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>=</mo><mo>=</mo><mi>s</mi><mo>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">x == s[i+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> ï¼Œåä¹‹äº¦ç„¶ã€‚<br>
å¦‚æœ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo>!</mo><mo>=</mo><mi>s</mi><mo>[</mo><mi>i</mi><mo>+</mo><mn>1</mn><mo>]</mo></mrow><annotation encoding="application/x-tex">s[i] != s[i+1]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mclose">!</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">s</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span></span></span></span> é‚£ä¹ˆå°±ä¼šå‡ºç°3ç§æƒ…å†µ<br>
æ­£ç¡®æ•°é‡åŠ 1ï¼Œ<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;&amp;&#039; at position 11: x != s[i] &amp;Ì²&amp; x == s[i+1]'>x != s[i] &amp;&amp; x == s[i+1]</span><br>
æ­£ç¡®æ•°é‡å‡1ï¼Œ<span class='katex-error' title='ParseError: KaTeX parse error: Expected &#039;EOF&#039;, got &#039;&amp;&#039; at position 11: x == s[i] &amp;Ì²&amp; x != s[i+1]'>x == s[i] &amp;&amp; x != s[i+1]</span><br>
æ­£ç¡®æ•°é‡ä¸å˜, other<br>
æ‰€æœ‰ä½ç½®å¡«å†™ç­”æ¡ˆçš„ä¸åŒæ–¹æ¡ˆæ€»æ•°ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>k</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">k^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">n</span></span></span></span></span></span></span></span></span></span></span>,ä¼šæœ‰æ­£ç¡®ç­”æ¡ˆå¤šäºåŸå…ˆçš„ï¼Œæ­£ç¡®ç­”æ¡ˆå°‘äºåŸå…ˆçš„ï¼Œæ­£ç¡®ç­”æ¡ˆç­‰äºåŸå…ˆçš„ä¸‰ç§æƒ…å†µï¼Œæ€è€ƒåå¯ä»¥å‘ç°ï¼Œå¤šäºåŸå…ˆå’Œå°‘äºåŸå…ˆçš„æ–¹æ¡ˆæ•°æ˜¯ç›¸ç­‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰€æ±‚å¤šäºåŸå…ˆçš„æ–¹æ¡ˆæ•°å¯ä»¥è½¬åŒ–ä¸ºæ±‚(æ€»æ–¹æ¡ˆæ•° - ç­”æ¡ˆç­‰äºåŸå…ˆæ–¹æ¡ˆæ•°)/2ï¼Œ<br>
å› ä¸ºè¦æ±‚ç­”æ¡ˆæ•°ç­‰äºåŸå…ˆæ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥å½“é€‰å–äº†<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ªæ­£ç¡®æ•°é‡+1çš„æ–¹æ¡ˆæ•°æ—¶ï¼Œå°±å¿…é¡»é€‰å¯¹åº”çš„<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>ä¸ªæ­£ç¡®æ•°é‡-1çš„æ–¹æ¡ˆæ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è€ƒè™‘æšä¸¾<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>,ç„¶åé€šè¿‡ç»„åˆåŸç†æ±‚å‡ºæ€»æ•°</p>
<h4 id="ä»£ç ">ä»£ç </h4>
<pre><code class="language-cpp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;algorithm&gt;
using namespace std;
const int maxd = 2e5+10;
typedef long long ll;
const int mod = 998244353;
int n,k,num,a[maxd];
long long fac[maxd];
ll pow(ll a,ll b)
{
    ll ans = 1ll;
    while(b)
    {
        if(b&amp;1) ans = ans * a %mod;
        a = a * a % mod;
        b /= 2;
    }
    return ans;
}
ll C(ll a,ll b)
{
    return 1ll* (fac[a] * pow(fac[b],1ll * mod-2) % mod) * pow(fac[a-b],mod-2) %mod;
}
int main()
{
//    freopen(&quot;a.in&quot;,&quot;r&quot;,stdin);
//    freopen(&quot;k.out&quot;,&quot;w&quot;,stdout);
    scanf(&quot;%d %d&quot;,&amp;n,&amp;k);
    if(k == 1) {printf(&quot;0&quot;);return 0;}
    for(int i=1;i&lt;=n;i++) scanf(&quot;%d&quot;,&amp;a[i]);
    for(int i=1;i&lt;n;i++) if(a[i] != a[i+1]) num++; num += (a[1] != a[n]);
 
    fac[0] = 1ll;for(int i=1;i&lt;maxd;i++) fac[i] = 1ll * fac[i-1] * i %mod;
 
//    for(int i=1;i&lt;=n;i++)
//
    long long ans = 0ll;
 
    for(int i=0;i * 2 &lt;= num;i++) {
        long long tmp = C(num, i) * C(num - i, i) % mod * pow(k - 2, num - i - i) % mod * pow(k, n-num) % mod;
        ans = (tmp + ans) % mod;
    }
    //for(int i=1;i&lt;=10;i++) printf(&quot;%lld \n&quot;,pow(2,i));
    printf(&quot;%lld\n&quot;,((pow(k,n) - ans)%mod  + mod ) %mod * pow(2,mod-2) %mod );
    return 0;
}
</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">ç›®å½•</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#%E9%93%BE%E6%8E%A5">é“¾æ¥ğŸ”—</a></li>
<li><a href="#%E9%A2%98%E8%A7%A3">é¢˜è§£</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81">ä»£ç </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*è·å–æ–‡ç« ç›®å½•é›†åˆ,å¯é€šè¿‡:headerè¿‡æ»¤å™¨*/
                var alis = $('.post-content :header');
                /*è·å–ä¾§è¾¹æ ç›®å½•åˆ—è¡¨é›†åˆ**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*è·å–æ»šåŠ¨æ¡åˆ°é¡¶éƒ¨çš„è·ç¦»*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*è·å–é”šç‚¹é›†åˆä¸­çš„å…ƒç´ åˆ†åˆ«åˆ°é¡¶ç‚¹çš„è·ç¦»*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*é«˜äº®æ˜¾ç¤º*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*ç»‘å®šæ»šåŠ¨äº‹ä»¶ */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.css" integrity="sha384-b/NoaeRXkMxyKcrDw2KtVtYKkVg3dA0rTRgLoV7W2df3MzeR1eHLTi+l4//4fMwk" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.js" integrity="sha384-ern5NCRqs6nJ/a4Ik0nB9hnKVH5HwV2XRUYdQl09OB/vvd1Lmmqbg1Mh+mYUclXx" crossorigin="anonymous"></script> | 
  <a class="rss" href="https://dinnerhunt.cn/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>