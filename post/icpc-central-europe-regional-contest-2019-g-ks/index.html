<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    ã€ŒICPC Central Europe Regional Contest 2019ã€ G. K==S | dinnerhunt
</title>
<link rel="shortcut icon" href="https://dinnerhunt.cn/favicon.ico?v=1654671103475">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://dinnerhunt.cn/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dinnerhunt.cn/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/stackoverflow-light.min.css">

<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://dinnerhunt.cn">
                <img class="avatar" src="https://dinnerhunt.cn/images/avatar.png?v=1654671103475" alt="">
            </a>
            <div class="site-title">
                <h1>
                    dinnerhunt
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    é¦–é¡µ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    å½’æ¡£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    æ ‡ç­¾
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    å…³äº
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/friend" class="menu">
                                    å‹é“¾
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            ã€ŒICPC Central Europe Regional Contest 2019ã€ G. K==S
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2020-05-21</time>
                            
                                <a href="https://dinnerhunt.cn/tag/OuaWiLQNF/" class="post-tag i-tag
                            i-tag-warning">
                            #ACè‡ªåŠ¨æœº
                        </a>
                                
                                <a href="https://dinnerhunt.cn/tag/fUltFljdO/" class="post-tag i-tag
                            i-tag-warning">
                            #çŸ©é˜µä¹˜æ³•
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>Progressive hard octave rock tunes (so-called â€œphortsâ€) are written using a specifific music notation. This flflavor of rock is built on just 13 difffferent note pitches, other pitches (in other octaves)are considered to be an outdated musical ballast. Each note can be either a long one or a shortone. Consequently, there are exactly 26 difffferent notes in the rock.</p>
<!--more-->
<p>You are going to compose a phort tune on the occasion of your friendâ€™s birthday and perform itwith your band on the main town square. While composing the phort, you need to avoid certainmusical phrases, which are heavily copyrighted as a result of long research sponsored by bigrecord companies. It has been established that these phrases are very catchy, easy to remember,and could be exploited to bind the listeners subconsciously to a particular music company whichwould utilize these phrases in their production.</p>
<p>The tune is a sequence of notes. A musical phrase is also a sequence of notes and it is consideredto be contained in a tune if its notes form a contiguous subsequence of the tune, which meansthe same notes appear in the tune right after each other in the same order.</p>
<p>Fortunately, only a few forbidden phrases have been patented so far. Thus, you have a relativefreedom in composing your own tunes. In particular, you are interested in the number ofacceptable tunes of some length. An acceptable tune is any tune which does not contain aforbidden phrase. The length of the tune is equal to the number of notes it contains.</p>
<h4 id="å¤§è‡´é¢˜æ„">å¤§è‡´é¢˜æ„ ğŸ“–</h4>
<p>ç»™å®š<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>q</mi></mrow><annotation encoding="application/x-tex">q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">q</span></span></span></span>ä¸ªé•¿åº¦å’Œä¸è¶…è¿‡100çš„å­—ç¬¦ä¸²<br>
æ±‚é•¿åº¦ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">n</span></span></span></span>ï¼Œä¸åŒ…å«ä¸Šé¢ä»»æ„å­ä¸²çš„å­—ç¬¦ä¸²æ–¹æ¡ˆæ•°</p>
<h4 id="é“¾æ¥">é“¾æ¥ ğŸ”—</h4>
<p><a href="https://vjudge.net/problem/1673480/origin">ã€ŒICPC Central Europe Regional Contest 2019ã€ G. K==S</a></p>
<h4 id="é¢˜è§£">é¢˜è§£  â“</h4>
<p>å°†ä¸åˆæ³•å­—ç¬¦ä¸²æ„å»ºè‡ªåŠ¨æœºï¼Œç„¶åå¯¹äºæ¯ä¸ªèŠ‚ç‚¹æ‰“ç®—ä¸åˆæ³•æ ‡è®°<br>
ç„¶åå°±å°†é—®é¢˜è½¬åŒ–æˆäº†ä»ç‚¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span>å¼€å§‹ï¼Œä¸èƒ½åˆ°è¾¾ä¸åˆæ³•ç‚¹æ–¹æ¡ˆæ•°<br>
è¿™æ ·å°±å˜æˆäº† <a href="https://www.luogu.com.cn/problem/P3758">TJOI2017 å¯ä¹</a><br>
æ³¨æ„ä¸€ä¸‹ï¼Œå¯¹äºä¸€ä¸ªç‚¹<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>,å¦‚æœ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>a</mi><mi>i</mi><mi>l</mi><mo>[</mo><mi>x</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">fail[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mord mathdefault">i</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span>ä¸åˆæ³•ï¼Œé‚£ä¹ˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>ä¹Ÿä¸åˆæ³•</p>
<h4 id="ä»£ç ">ä»£ç </h4>
<pre><code class="language-cpp">const int mod = 1e9+7;
const double eps = 1e-8;
const double pi = acos(-1);
const int N = 2e5+10;
struct AC_Automaton
{
    ll ch[N][26],fail[N],cnt[N],tot;
    void init()
    {
        MM(ch,-1);MM(fail,0);MM(cnt,0);
        tot = 0;
    }
    void insert(char *s)
    {
        ll p = 0,len = strlen(s);
        FOR(i,0,len-1)
        {
            if(ch[p][s[i] - 'a'] == -1) ch[p][s[i]-'a'] = ++tot;
            p = ch[p][s[i] - 'a'];
        }
        cnt[p]++;
    }
    void build()
    {
        queue&lt;ll&gt; que;
        FOR(i,0,25)
        {
            if(ch[0][i] == -1) ch[0][i] = 0;
            else que.push(ch[0][i]);
        }
        while(!que.empty())
        {
            ll p = que.front(); que.pop();
            FOR(i,0,25)
            {
                if(ch[p][i] == -1) ch[p][i] = ch[fail[p]][i];
                else
                {
                    fail[ch[p][i]] = ch[fail[p]][i], que.push(ch[p][i]);
                    cnt[ch[p][i]] |= cnt[ch[fail[p]][i]];
                }
            }
        }
    }
}AC;
char s[201];
struct Matrix_Pow
{
    ll n;
    struct matrix
    {
        long long a[205][205];
    }ans,base,C;
    void init()
    {
        MM(ans.a,0);
        MM(base.a,0);
        FOR(i,1,204) ans.a[i][i] = 1;
    }
    matrix matrix_mul(matrix A, matrix B)
    {
        matrix C;
        for (int i = 1; i &lt;= n; ++i)
            for (int j = 1; j &lt;= n; ++j)
            {
                C.a[i][j] = 0;
                for (int k = 1; k &lt;= n; ++k) C.a[i][j] = (C.a[i][j] + (A.a[i][k] * B.a[k][j] % mod)) % mod;
            }
        return C;
    }
    void matrix_pow(long long b)
    {
        for (; b; b &gt;&gt;= 1)
        {
            if (b &amp; 1) ans = matrix_mul(ans, base);
            base = matrix_mul(base, base);
        }
    }
}M;
int main()
{
//    __IN;__OUT;
    ll n,m;RLL2(n,m);
    AC.init();
    FOR(i,1,m)
    {
        ll x;RLL(x);
        RS(s);
        AC.insert(s);
    }
    AC.build();
    M.init();
    M.n = AC.tot+1;
    FOR(i,0,AC.tot)
    {
        if(AC.cnt[i]) continue;
        FOR(j,0,25)
        {
            ll v = AC.ch[i][j];
            if(AC.cnt[v]) continue;
            if(AC.ch[i][j] == -1) v = 0;
            M.base.a[i+1][v+1]++;
        }
    }
    M.matrix_pow(n);
    ll ans = 0;
    FOR(i,1,AC.tot+1)
        ans = (ans + M.ans.a[1][i])%mod;
    PLN(ans);
    return 0;
}
</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">ç›®å½•</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#%E5%A4%A7%E8%87%B4%E9%A2%98%E6%84%8F">å¤§è‡´é¢˜æ„ ğŸ“–</a></li>
<li><a href="#%E9%93%BE%E6%8E%A5">é“¾æ¥ ğŸ”—</a></li>
<li><a href="#%E9%A2%98%E8%A7%A3">é¢˜è§£  â“</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81">ä»£ç </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*è·å–æ–‡ç« ç›®å½•é›†åˆ,å¯é€šè¿‡:headerè¿‡æ»¤å™¨*/
                var alis = $('.post-content :header');
                /*è·å–ä¾§è¾¹æ ç›®å½•åˆ—è¡¨é›†åˆ**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*è·å–æ»šåŠ¨æ¡åˆ°é¡¶éƒ¨çš„è·ç¦»*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*è·å–é”šç‚¹é›†åˆä¸­çš„å…ƒç´ åˆ†åˆ«åˆ°é¡¶ç‚¹çš„è·ç¦»*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*é«˜äº®æ˜¾ç¤º*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*ç»‘å®šæ»šåŠ¨äº‹ä»¶ */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.css" integrity="sha384-b/NoaeRXkMxyKcrDw2KtVtYKkVg3dA0rTRgLoV7W2df3MzeR1eHLTi+l4//4fMwk" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.js" integrity="sha384-ern5NCRqs6nJ/a4Ik0nB9hnKVH5HwV2XRUYdQl09OB/vvd1Lmmqbg1Mh+mYUclXx" crossorigin="anonymous"></script> | 
  <a class="rss" href="https://dinnerhunt.cn/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>