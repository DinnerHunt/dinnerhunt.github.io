<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    「CodeForces 1241F」Stack Exterminable Arrays | dinnerhunt
</title>
<link rel="shortcut icon" href="https://dinnerhunt.cn/favicon.ico?v=1654671103475">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://dinnerhunt.cn/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dinnerhunt.cn/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/stackoverflow-light.min.css">

<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://dinnerhunt.cn">
                <img class="avatar" src="https://dinnerhunt.cn/images/avatar.png?v=1654671103475" alt="">
            </a>
            <div class="site-title">
                <h1>
                    dinnerhunt
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    首页
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    归档
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    标签
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    关于
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/friend" class="menu">
                                    友链
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            「CodeForces 1241F」Stack Exterminable Arrays
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2019-12-27</time>
                            
                                <a href="https://dinnerhunt.cn/tag/zgSE_vrd1/" class="post-tag i-tag
                            i-tag-primary">
                            #Hash
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>Let's look at the following process: initially you have an empty stack and an array 𝑠 of the length 𝑙. You are trying to push array elements to the stack in the order 𝑠1,𝑠2,𝑠3,…𝑠𝑙. Moreover, if the stack is empty or the element at the top of this stack is not equal to the current element, then you just push the current element to the top of the stack. Otherwise, you don't push the current element to the stack and, moreover, pop the top element of the stack.</p>
<!--more-->
<p>If after this process the stack remains empty, the array 𝑠 is considered stack exterminable.</p>
<p>There are samples of stack exterminable arrays:</p>
<p>[1,1];<br>
[2,1,1,2];<br>
[1,1,2,2];<br>
[1,3,3,1,2,2];<br>
[3,1,3,3,1,3];<br>
[3,3,3,3,3,3];<br>
[5,1,2,2,1,4,4,5];<br>
Let's consider the changing of stack more details if 𝑠=[5,1,2,2,1,4,4,5] (the top of stack is highlighted).</p>
<p>after pushing 𝑠1=5 the stack turn into [5];<br>
after pushing 𝑠2=1 the stack turn into [5,1];<br>
after pushing 𝑠3=2 the stack turn into [5,1,2];<br>
after pushing 𝑠4=2 the stack turn into [5,1];<br>
after pushing 𝑠5=1 the stack turn into [5];<br>
after pushing 𝑠6=4 the stack turn into [5,4];<br>
after pushing 𝑠7=4 the stack turn into [5];<br>
after pushing 𝑠8=5 the stack is empty.<br>
You are given an array 𝑎1,𝑎2,…,𝑎𝑛. You have to calculate the number of its subarrays which are stack exterminable.</p>
<p>Note, that you have to answer 𝑞 independent queries.</p>
<h4 id="链接">链接🔗</h4>
<p><a href="https://codeforces.com/contest/1241/problem/F">「CodeForces 1241F」Stack Exterminable Arrays</a></p>
<h4 id="题解">题解</h4>
<p>见到一种是否巧妙的方法<br>
可以发现如果「L,R」区间是合法出栈顺序，那么 「1,L」 和 「1,R」中剩下栈的元素与<strong>顺序</strong>都是<strong>相同</strong>的，因此他们的hash值一定是相同的，所以我们从头到位开始枚举，并用map存该值出现的次数，遇到时统计即可</p>
<h4 id="代码">代码</h4>
<pre><code class="language-cpp">const int maxd = 3e5+10;
const ull base = 300007;
typedef long long ll;

ll dp[maxd]; // 从该点开始，最多多少个后缀满足要求
ll last[maxd]; //该点不匹配的最后一个位置
map&lt;ull,int&gt;mp;
stack&lt;ll&gt; st;
ull has[maxd];
int main()
{
    //__IN;__OUT;
    ll t;RLL(t);
    while(t--)
    {
        ll n;RLL(n);
        mp.clear(); mp[0]=1; has[0]=0;
        while(!st.empty()) st.pop();
        ll ans = 0,l = 0;
        FOR(1,n)
        {
            ll x;RLL(x);
            if(st.empty() || st.top()!=x )
            {
                has[l+1] = (base * has[l] + x);
                l++;
                st.push(x);
            }
            else
            {
                l--;
                st.pop();
            }
            ans+= mp[has[l]];
            mp[has[l]]++;
        }
        PLL(ans);
        PN();
    }

    return 0;
}

</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">目录</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#%E9%93%BE%E6%8E%A5">链接🔗</a></li>
<li><a href="#%E9%A2%98%E8%A7%A3">题解</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81">代码</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*获取文章目录集合,可通过:header过滤器*/
                var alis = $('.post-content :header');
                /*获取侧边栏目录列表集合**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*获取滚动条到顶部的距离*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*获取锚点集合中的元素分别到顶点的距离*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*高亮显示*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*绑定滚动事件 */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.css" integrity="sha384-b/NoaeRXkMxyKcrDw2KtVtYKkVg3dA0rTRgLoV7W2df3MzeR1eHLTi+l4//4fMwk" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.js" integrity="sha384-ern5NCRqs6nJ/a4Ik0nB9hnKVH5HwV2XRUYdQl09OB/vvd1Lmmqbg1Mh+mYUclXx" crossorigin="anonymous"></script> | 
  <a class="rss" href="https://dinnerhunt.cn/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>