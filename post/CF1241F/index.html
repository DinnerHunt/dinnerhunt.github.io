<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    ã€ŒCodeForces 1241Fã€Stack Exterminable Arrays | dinnerhunt
</title>
<link rel="shortcut icon" href="https://dinnerhunt.cn/favicon.ico?v=1654671103475">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://dinnerhunt.cn/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dinnerhunt.cn/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/stackoverflow-light.min.css">

<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://dinnerhunt.cn">
                <img class="avatar" src="https://dinnerhunt.cn/images/avatar.png?v=1654671103475" alt="">
            </a>
            <div class="site-title">
                <h1>
                    dinnerhunt
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    é¦–é¡µ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    å½’æ¡£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    æ ‡ç­¾
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    å…³äº
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/friend" class="menu">
                                    å‹é“¾
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            ã€ŒCodeForces 1241Fã€Stack Exterminable Arrays
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2019-12-27</time>
                            
                                <a href="https://dinnerhunt.cn/tag/zgSE_vrd1/" class="post-tag i-tag
                            i-tag-primary">
                            #Hash
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>Let's look at the following process: initially you have an empty stack and an array ğ‘  of the length ğ‘™. You are trying to push array elements to the stack in the order ğ‘ 1,ğ‘ 2,ğ‘ 3,â€¦ğ‘ ğ‘™. Moreover, if the stack is empty or the element at the top of this stack is not equal to the current element, then you just push the current element to the top of the stack. Otherwise, you don't push the current element to the stack and, moreover, pop the top element of the stack.</p>
<!--more-->
<p>If after this process the stack remains empty, the array ğ‘  is considered stack exterminable.</p>
<p>There are samples of stack exterminable arrays:</p>
<p>[1,1];<br>
[2,1,1,2];<br>
[1,1,2,2];<br>
[1,3,3,1,2,2];<br>
[3,1,3,3,1,3];<br>
[3,3,3,3,3,3];<br>
[5,1,2,2,1,4,4,5];<br>
Let's consider the changing of stack more details if ğ‘ =[5,1,2,2,1,4,4,5] (the top of stack is highlighted).</p>
<p>after pushing ğ‘ 1=5 the stack turn into [5];<br>
after pushing ğ‘ 2=1 the stack turn into [5,1];<br>
after pushing ğ‘ 3=2 the stack turn into [5,1,2];<br>
after pushing ğ‘ 4=2 the stack turn into [5,1];<br>
after pushing ğ‘ 5=1 the stack turn into [5];<br>
after pushing ğ‘ 6=4 the stack turn into [5,4];<br>
after pushing ğ‘ 7=4 the stack turn into [5];<br>
after pushing ğ‘ 8=5 the stack is empty.<br>
You are given an array ğ‘1,ğ‘2,â€¦,ğ‘ğ‘›. You have to calculate the number of its subarrays which are stack exterminable.</p>
<p>Note, that you have to answer ğ‘ independent queries.</p>
<h4 id="é“¾æ¥">é“¾æ¥ğŸ”—</h4>
<p><a href="https://codeforces.com/contest/1241/problem/F">ã€ŒCodeForces 1241Fã€Stack Exterminable Arrays</a></p>
<h4 id="é¢˜è§£">é¢˜è§£</h4>
<p>è§åˆ°ä¸€ç§æ˜¯å¦å·§å¦™çš„æ–¹æ³•<br>
å¯ä»¥å‘ç°å¦‚æœã€ŒL,Rã€åŒºé—´æ˜¯åˆæ³•å‡ºæ ˆé¡ºåºï¼Œé‚£ä¹ˆ ã€Œ1,Lã€ å’Œ ã€Œ1,Rã€ä¸­å‰©ä¸‹æ ˆçš„å…ƒç´ ä¸<strong>é¡ºåº</strong>éƒ½æ˜¯<strong>ç›¸åŒ</strong>çš„ï¼Œå› æ­¤ä»–ä»¬çš„hashå€¼ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»å¤´åˆ°ä½å¼€å§‹æšä¸¾ï¼Œå¹¶ç”¨mapå­˜è¯¥å€¼å‡ºç°çš„æ¬¡æ•°ï¼Œé‡åˆ°æ—¶ç»Ÿè®¡å³å¯</p>
<h4 id="ä»£ç ">ä»£ç </h4>
<pre><code class="language-cpp">const int maxd = 3e5+10;
const ull base = 300007;
typedef long long ll;

ll dp[maxd]; // ä»è¯¥ç‚¹å¼€å§‹ï¼Œæœ€å¤šå¤šå°‘ä¸ªåç¼€æ»¡è¶³è¦æ±‚
ll last[maxd]; //è¯¥ç‚¹ä¸åŒ¹é…çš„æœ€åä¸€ä¸ªä½ç½®
map&lt;ull,int&gt;mp;
stack&lt;ll&gt; st;
ull has[maxd];
int main()
{
    //__IN;__OUT;
    ll t;RLL(t);
    while(t--)
    {
        ll n;RLL(n);
        mp.clear(); mp[0]=1; has[0]=0;
        while(!st.empty()) st.pop();
        ll ans = 0,l = 0;
        FOR(1,n)
        {
            ll x;RLL(x);
            if(st.empty() || st.top()!=x )
            {
                has[l+1] = (base * has[l] + x);
                l++;
                st.push(x);
            }
            else
            {
                l--;
                st.pop();
            }
            ans+= mp[has[l]];
            mp[has[l]]++;
        }
        PLL(ans);
        PN();
    }

    return 0;
}

</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">ç›®å½•</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#%E9%93%BE%E6%8E%A5">é“¾æ¥ğŸ”—</a></li>
<li><a href="#%E9%A2%98%E8%A7%A3">é¢˜è§£</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81">ä»£ç </a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*è·å–æ–‡ç« ç›®å½•é›†åˆ,å¯é€šè¿‡:headerè¿‡æ»¤å™¨*/
                var alis = $('.post-content :header');
                /*è·å–ä¾§è¾¹æ ç›®å½•åˆ—è¡¨é›†åˆ**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*è·å–æ»šåŠ¨æ¡åˆ°é¡¶éƒ¨çš„è·ç¦»*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*è·å–é”šç‚¹é›†åˆä¸­çš„å…ƒç´ åˆ†åˆ«åˆ°é¡¶ç‚¹çš„è·ç¦»*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*é«˜äº®æ˜¾ç¤º*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*ç»‘å®šæ»šåŠ¨äº‹ä»¶ */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.css" integrity="sha384-b/NoaeRXkMxyKcrDw2KtVtYKkVg3dA0rTRgLoV7W2df3MzeR1eHLTi+l4//4fMwk" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.js" integrity="sha384-ern5NCRqs6nJ/a4Ik0nB9hnKVH5HwV2XRUYdQl09OB/vvd1Lmmqbg1Mh+mYUclXx" crossorigin="anonymous"></script> | 
  <a class="rss" href="https://dinnerhunt.cn/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>