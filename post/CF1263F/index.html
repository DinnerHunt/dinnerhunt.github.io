<html>

<head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>
    „ÄåCF1263F„ÄçEconomic Difficulties | dinnerhunt
</title>
<link rel="shortcut icon" href="https://dinnerhunt.cn/favicon.ico?v=1654671103475">
<!-- <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous"> -->
<link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://dinnerhunt.cn/styles/main.css">
<!-- js -->
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
<script src="https://dinnerhunt.cn/media/js/jquery.sticky-sidebar.min.js"></script>
<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<link rel="stylesheet"
      href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/styles/stackoverflow-light.min.css">

<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>


        
</head>

<body>
    <div class="main">
        <div class="header">
    <div class="nav">
        <div class="logo">
            <a href="https://dinnerhunt.cn">
                <img class="avatar" src="https://dinnerhunt.cn/images/avatar.png?v=1654671103475" alt="">
            </a>
            <div class="site-title">
                <h1>
                    dinnerhunt
                </h1>
            </div>
        </div>
        <span class="menu-btn fa fa-align-justify"></span>
        <div class="menu-container">
            <ul>
                
                    
                            <li>
                                <a href="/" class="menu">
                                    È¶ñÈ°µ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/archives" class="menu">
                                    ÂΩíÊ°£
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/tags" class="menu">
                                    Ê†áÁ≠æ
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/about" class="menu">
                                    ÂÖ≥‰∫é
                                </a>
                            </li>
                            
                                
                    
                            <li>
                                <a href="/post/friend" class="menu">
                                    ÂèãÈìæ
                                </a>
                            </li>
                            
                                
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $(".menu-btn").click(function() {
            $(".menu-container").slideToggle();
        });
        $(window).resize(function() {

            if (window.matchMedia('(min-width: 960px)').matches) {
                $(".menu-container").css('display', 'block')
            } else {
                $(".menu-container").css('display', 'none')
            }

        });
    });
</script>

            <div id="main-content" class="post-detail main-container">
                <!-- left -->
                <div id="content" class="main-container-left">
                    <article class="post i-card">
                        <h2 class="post-title">
                            „ÄåCF1263F„ÄçEconomic Difficulties
                        </h2>
                        <div class="post-info">
                            <time class="post-time">2019-12-13</time>
                            
                                <a href="https://dinnerhunt.cn/tag/zRUj8NbTE/" class="post-tag i-tag
                            i-tag-success">
                            #DP
                        </a>
                                
                                <a href="https://dinnerhunt.cn/tag/gjqxZB9f1/" class="post-tag i-tag
                            i-tag-other_2">
                            #Ê†ë‰∏äÈóÆÈ¢ò
                        </a>
                                
                        </div>
                        
                                <div class="post-content">
                                    <p>An electrical grid in Berland palaces consists of 2 grids: main and reserve. Wires in palaces are made of expensive material, so selling some of them would be a good idea!</p>
<p>Each grid (main and reserve) has a head node (its number is 1). Every other node gets electricity from the head node. Each node can be reached from the head node by a unique path. Also, both grids have exactly n nodes, which do not spread electricity further.</p>
<!--more-->
<p>In other words, every grid is a rooted directed tree on n leaves with a root in the node, which number is 1. Each tree has independent enumeration and nodes from one grid are not connected with nodes of another grid.</p>
<p>Also, the palace has n electrical devices. Each device is connected with one node of the main grid and with one node of the reserve grid. Devices connect only with nodes, from which electricity is not spread further (these nodes are the tree's leaves). Each grid's leaf is connected with exactly one device.</p>
<p>In this example the main grid contains 6 nodes (the top tree) and the reserve grid contains 4 nodes (the lower tree). There are 3 devices with numbers colored in blue.<br>
It is guaranteed that the whole grid (two grids and ùëõ devices) can be shown in this way (like in the picture above):</p>
<p>main grid is a top tree, whose wires are directed 'from the top to the down',<br>
reserve grid is a lower tree, whose wires are directed 'from the down to the top',<br>
devices ‚Äî horizontal row between two grids, which are numbered from 1 to ùëõ from the left to the right,<br>
wires between nodes do not intersect.<br>
Formally, for each tree exists a depth-first search from the node with number 1, that visits leaves in order of connection to devices 1,2,‚Ä¶,ùëõ (firstly, the node, that is connected to the device 1, then the node, that is connected to the device 2, etc.).</p>
<p>Businessman wants to sell (remove) maximal amount of wires so that each device will be powered from at least one grid (main or reserve). In other words, for each device should exist at least one path to the head node (in the main grid or the reserve grid), which contains only nodes from one grid.</p>
<h4 id="ÈìæÊé•">ÈìæÊé•üîó</h4>
<p><a href="https://codeforces.com/contest/1263/problem/F">„ÄåCodeForces 1263F„ÄçEconomic Difficulties</a></p>
<h4 id="È¢òËß£">È¢òËß£</h4>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>n</mi><mo>&lt;</mo><mo>=</mo><mn>2000</mn></mrow><annotation encoding="application/x-tex">n&lt;=2000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">n</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&lt;</span></span><span class="base"><span class="strut" style="height:0.36687em;vertical-align:0em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">2</span><span class="mord">0</span><span class="mord">0</span><span class="mord">0</span></span></span></span>ÔºåËÄÉËôëDPÂÅöÊ≥ï,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi><mi>P</mi><mo>[</mo><mi>t</mi><mo>]</mo><mo>[</mo><mi>i</mi><mo>]</mo><mo>[</mo><mi>j</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">DP[t][i][j]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mopen">[</span><span class="mord mathdefault">t</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span><span class="mclose">]</span></span></span></span>,Ë°®Á§∫Á¨¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> Ê£µÊ†ëÂ∞Ü <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi><mo>‚àí</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i-j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">i</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">‚àí</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.05724em;">j</span></span></span></span> Âå∫Èó¥Êñ≠ÁîµÊúÄÂ§öËÉΩÂà†Èô§Â§öÂ∞ëËæπ<br>
ÁÑ∂Âêé<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi><mo>[</mo><mi>i</mi><mo>]</mo><mo separator="true">,</mo><mi>R</mi><mo>[</mo><mi>i</mi><mo>]</mo></mrow><annotation encoding="application/x-tex">L[i],R[i]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">L</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.00773em;">R</span><span class="mopen">[</span><span class="mord mathdefault">i</span><span class="mclose">]</span></span></span></span>Áî®Êù•Áª¥Êä§ËØ•ËäÇÁÇπÁª¥Êä§‰∏ãÈù¢Ë¶ÜÁõñ‰∫ÜÈÇ£‰∫õÂ≠êËäÇÁÇπÔºåÊúÄÂêéÂÜçÁî®DPÂêàÂπ∂‰∏Ä‰∫õÂç≥ÂèØ</p>
<h4 id="‰ª£Á†Å">‰ª£Á†Å</h4>
<pre><code class="language-cpp">#include &lt;cstdio&gt;
#include &lt;cstring&gt;
#include &lt;vector&gt;
#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;queue&gt;
#include &lt;map&gt;
#include &lt;string&gt;
using namespace std;
const int maxd = 2e3+10;
vector&lt;int&gt; G[2][maxd];
int dp[maxd],v[2][maxd][maxd],l[2][maxd],r[2][maxd],sz[2][maxd];
// L[i]ÔºåR[i]Ë°®Á§∫Â∞ÜÁõñ‰ª•iËäÇÁÇπ‰∏∫Ê†πÂ≠êÊ†ëÂà†ÊéâÔºåÊúÄÂ§öËÉΩ‰ΩøÂæó[L,R]Âå∫Èó¥ÂÜÖÁöÑÂèëÁîµÊú∫ÂÅúÁîµ
int n,a;
void dfs(int id,int x)
{
    if(x!=1) sz[id][x] = 1; // N‰∏™ÁÇπn-1Êù°ËæπÔºåÊ†πËäÇÁÇπÊó†Áà∂Ëæπ
    for(int v :G[id][x])
    {
        dfs(id,v);
        l[id][x] = min(l[id][x],l[id][v]);
        r[id][x] = max(r[id][x],r[id][v]);
        sz[id][x] += sz[id][v];
    }
    int ll = l[id][x],rr = r[id][x];
    v[id][ll][rr] = max(v[id][ll][rr],sz[id][x]);    // ‰ª£‰ª∑ÊòØËØ•Â≠êÊ†ëÁöÑÂ§ßÂ∞è
}
int main()
{
//    freopen(&quot;a.in&quot;,&quot;r&quot;,stdin);
//    freopen(&quot;k.out&quot;,&quot;w&quot;,stdout);
    int n;scanf(&quot;%d&quot;,&amp;n);
    for(int t=0;t &lt; 2;t++)
    {
        int m;scanf(&quot;%d&quot;,&amp;m);
        for(int i=1;i&lt;=m;i++)
        {
            l[t][i] = m+1;
            r[t][i] = 0;
        }
        for(int i=2;i&lt;=m;i++)
        {
            int x; scanf(&quot;%d&quot;,&amp;x);
            G[t][x].push_back(i);
        }
        for(int i=1;i&lt;=n;i++)
        {
            int x;scanf(&quot;%d&quot;,&amp;x);
            l[t][x] = r[t][x] = i;
        }
        dfs(t,1);
    }
    for(int i=1;i&lt;=n;i++)
        for(int j=i;j&lt;=n;j++)
            dp[j] = max(dp[j], dp[i-1] + max(v[0][i][j],v[1][i][j]));
    printf(&quot;%d\n&quot;,dp[n]);
    return 0;
}
</code></pre>

                                </div>
                    </article>
                    <!--  -->
                    
                            <div id="disqus_thread"></div>
                            <div id="gitalk-container"></div>
                </div>
                <!-- middle -->
                <div class="main-container-middle"></div>
                <!-- right -->
                <div id="sidebar" class="main-container-right">
                    
                        <!-- toc -->
                        
    <div class="toc-card i-card ">
        <div class="toc-title i-card-title">ÁõÆÂΩï</div>
        <div class="toc-content">
            <ul class="markdownIt-TOC">
<li>
<ul>
<li>
<ul>
<li>
<ul>
<li><a href="#%E9%93%BE%E6%8E%A5">ÈìæÊé•üîó</a></li>
<li><a href="#%E9%A2%98%E8%A7%A3">È¢òËß£</a></li>
<li><a href="#%E4%BB%A3%E7%A0%81">‰ª£Á†Å</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
        <script>
            function locateCatelogList() {
                /*Ëé∑ÂèñÊñáÁ´†ÁõÆÂΩïÈõÜÂêà,ÂèØÈÄöËøá:headerËøáÊª§Âô®*/
                var alis = $('.post-content :header');
                /*Ëé∑Âèñ‰æßËæπÊ†èÁõÆÂΩïÂàóË°®ÈõÜÂêà**/
                var sidebar_alis = $('.markdownIt-TOC a');
                /*Ëé∑ÂèñÊªöÂä®Êù°Âà∞È°∂ÈÉ®ÁöÑË∑ùÁ¶ª*/
                var scroll_height = $(window).scrollTop();
                for (var i = 0; i < alis.length; i++) {
                    /*Ëé∑ÂèñÈîöÁÇπÈõÜÂêà‰∏≠ÁöÑÂÖÉÁ¥†ÂàÜÂà´Âà∞È°∂ÁÇπÁöÑË∑ùÁ¶ª*/
                    var a_height = $(alis[i]).offset().top;
                    if (a_height < scroll_height) {
                        /*È´ò‰∫ÆÊòæÁ§∫*/
                        sidebar_alis.removeClass('on');
                        $(sidebar_alis[i]).addClass('on');
                    }
                }
            }
            $(function() {
                /*ÁªëÂÆöÊªöÂä®‰∫ã‰ª∂ */
                $(window).bind('scroll', locateCatelogList);
            });
        </script>
    </div>
    
                            

                </div>




            </div>


            <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.css" integrity="sha384-b/NoaeRXkMxyKcrDw2KtVtYKkVg3dA0rTRgLoV7W2df3MzeR1eHLTi+l4//4fMwk" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.js" integrity="sha384-ern5NCRqs6nJ/a4Ik0nB9hnKVH5HwV2XRUYdQl09OB/vvd1Lmmqbg1Mh+mYUclXx" crossorigin="anonymous"></script> | 
  <a class="rss" href="https://dinnerhunt.cn/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>


    </div>
    <script>
        $('#sidebar').stickySidebar({
            topSpacing: 80,
            // bottomSpacing: 60
        });
    </script>
    
</body>

</html>